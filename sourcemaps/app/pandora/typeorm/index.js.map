{"version":3,"sources":["app/pandora/typeorm/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;AACA,iCAAmE;AAEtD,QAAA,OAAO,GAAG,KAAK,EAAE,GAAgB,EAAE,EAAE;IAC9C,MAAM,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC,OAAO,CAAA;IACjC,IAAI,CAAC,MAAM,EAAE;QACT,MAAM,IAAI,KAAK,CAAC,sCAAsC,CAAC,CAAA;KAC1D;IAED,GAAG,CAAC,WAAW,CAAC,KAAK,IAAI,EAAE;QACvB,IAAI;YACA,MAAM,gBAAS,CAAC,GAAG,CAAC,CAAA;YACpB,oCAAoC;YACpC,kBAAW,CAAC,GAAG,CAAC,CAAA;YAChB,IAAI;YACJ,MAAM,yBAAkB,CAAC,GAAG,CAAC,CAAA;YAC7B,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAA;SACzC;QAAC,OAAO,KAAK,EAAE;YACZ,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,WAAW,EAAE,SAAS,CAAC,CAAA;YACxC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;SAC1B;IACL,CAAC,CAAC,CAAA;AACN,CAAC,CAAC;AAEF,yCAAuB;AACvB,wCAAsB","file":"../../../../app/pandora/typeorm/index.js","sourcesContent":["import { Application } from 'egg'\nimport { connectDB, loadEntityAndModel, watchEntity } from './core'\n\nexport const typeorm = async (app: Application) => {\n    const config = app.config.typeorm\n    if (!config) {\n        throw new Error('please config typeorm in config file')\n    }\n\n    app.beforeStart(async () => {\n        try {\n            await connectDB(app)\n            // if (app.config.env === 'local') {\n            watchEntity(app)\n            // }\n            await loadEntityAndModel(app)\n            app.logger.info('[typeorm]', '数据链接成功')\n        } catch (error) {\n            app.logger.error('[typeorm]', '数据库链接失败')\n            app.logger.error(error)\n        }\n    })\n};\n\nexport * from './core';\nexport * from './orm';\n"]}